<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MauiHttp.Pages.ActorListPage"
             Title="List of Actors from the API"
             xmlns:vm="clr-namespace:MauiHttp.ViewModels"
             xmlns:models="clr-namespace:MauiHttp.Models"
             Shell.FlyoutBehavior="Flyout"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:DataType="vm:ActorListViewModel">
    
    <!--Example of a converter from the MAUI Community Toolkit:-->
    <ContentPage.Resources>
        <ResourceDictionary>
            <Color x:Key="TrueColor">Green</Color>
            <Color x:Key="FalseColor">Gray</Color>

            <toolkit:BoolToObjectConverter x:Key="IsFavoConverter" 
                TrueObject="{StaticResource TrueColor}" 
                FalseObject="{StaticResource FalseColor}"/>
        </ResourceDictionary>
    </ContentPage.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition Height="*"></RowDefinition>
        </Grid.RowDefinitions>
        
        <Label Padding="20" Text="Press the button to load a list of actors, swipe to add to favorites"></Label>
        <Button Grid.Row="1" Text="LOAD" Command="{Binding GetListCommand}" HorizontalOptions="Center" BackgroundColor="#007ACC" Margin="20"></Button>
        <CollectionView Grid.Row="2" ItemsSource="{Binding Actors}">
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="models:Actor">
                    <SwipeView>
                        <SwipeView.LeftItems>
                            <SwipeItems>
                                <SwipeItem Text="❤️"
                                    BackgroundColor="LightGreen"
                                    Command="{Binding 
                                    Source={RelativeSource AncestorType={x:Type vm:ActorListViewModel}}, Path=AddToFavoritesCommand}" 
                                           CommandParameter="{Binding .}" 
                                    />
                            </SwipeItems>
                        </SwipeView.LeftItems>
                        <Border Margin="5" 
                            BackgroundColor="{Binding IsFavorite, 
                                Converter={StaticResource IsFavoConverter}}" 
                            StrokeShape="RoundRectangle 50">
                            <StackLayout Orientation="Horizontal" Padding="10" Spacing="10" >
                                <Border StrokeShape="RoundRectangle 40">
                                    <Image Source="{Binding ProfilePictureUrl}" 
                                           HeightRequest="80" 
                                           WidthRequest="80" 
                                           Aspect="AspectFill"
                                           HorizontalOptions="Center"
                                           VerticalOptions="Center"
                                           />
                                </Border>
                                <StackLayout VerticalOptions="Center">
                                    <Label Text="{Binding LastName}" 
                                               FontSize="16" 
                                               FontAttributes="Bold" 
                                               TextColor="Black" />
                                    <Label Text="{Binding FirstName}" 
                                               FontSize="14" 
                                               TextColor="DarkGray" />
                                </StackLayout>
                            </StackLayout>
                        </Border>
                    </SwipeView>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentPage>